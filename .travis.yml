sudo: required
language: generic
cache:
- apt
notifications:
  email: false
  slack:
    rooms:
      secure: biz/WsHM8gINfHQZTunI46IxURYjXYqi5aKM1o750bOESq1zhB+rVBgBeTWil/18tlI7EwnuVA0GKaH3wzzna4k8BBaBUw00+G6WdaPiYT4NiDT7RuRiAuMpG9BlXyyYkdYbntChSF4D36FfsqbyIyqPQbaiHHMRFFKhZBzlM3TwKnAmgFt78VE1JnLI9XrOib0dI6bgeaRikrJDXmVYXwigkkkS9+3EC2AaW5kENX3BacE60ZcDTPQTrye8HGnOoKKKATbGhITgJErUFUn/GOluH8qauoBaVRBhQZWwUOq8M6sk1QRpwhZ2DZZCt+32Yra9Nuq3bavZ7lDIrQorAD5XGuPFw7mznJ81U3rkZ1nGNOqsqNTdXaoISVXqIRaLVZ9zENBBCyHmWRUrCRiSjqyM7P7d2Y/D3u0UVOJMI6V7WEEgSZyXc9oxH+KqAwf4ZuYSCy3lagej93lZUm1ENcuARe4/kqLiAgnf60oBxTcq2Z5m6r5rBT7dB82TlSUqwyOqAUkP6NrbfeMEaj8GBBUJCQLY4trSazmk0tjBrMDzzZ1ucvxiQ9dj6UH/NfFwpVNWT5/DPwhLdx6J7I3wvVhnlLADUtWiTdXc0g42Z/YIv6CTi2i1SSS3IHAcYlNLOblKQPo+2hW9ISwJF4z+XfqT/wKTxsSgcIZspbOlzSg=
    on_success: change
    on_failure: always
env:
  global:
  - ROS_CI_DESKTOP="`lsb_release -cs`"
  - CI_SOURCE_PATH=$(pwd)
  - ROSINSTALL_FILE=$CI_SOURCE_PATH/dependencies.rosinstall
  - CATKIN_OPTIONS=$CI_SOURCE_PATH/catkin.options
  - ROS_PARALLEL_JOBS='-j8 -l6'
  - REPO_NAME=ros_speech2text
  - secure: STRpcqvGYbbmuvtgLIouJloeUib6sljp4BiXCtS1m7xRpwd33N9VMsO2nUSbvNzpKJl/TRGj0bmrjs0XbHKPdadyKPtwKl1sGD2oNJQSi8dNF0ACWwVuLwamaSnAGd8Y7PY5Dkh2NyPSVjYDxNP5nGC+cY/Jnjn3gMayln6YRBIERWilfu5iKOXqVZ9sCOneKNG+t6QrZrdMxCxwDvJuS73ZMb+J/e+OjWDnojwv/Px6DhiDsmyyQcpFOItfCY18PoCScLgwc9b/0RyLApOayJPGNIrEMgfi61BPh9rbqTkO7KRUCggg9cc6TvKprAYHdBFcjHekCL6q8FWRhCAY14tO0E1Phm8YIOD8GPCmdN9G5qcye4bb3V+LpbNXHrwQzXlhNA++Q73W3djem9At/Xxxlvjo13iGpcJEd+ORy1YYFadAzRabo5Qev3m6l6Q+FoarKjsllLVtmXPSbXuTPXjyPIdvCKFTUfDpKET8z3BQUm/U9JRF92tlbt+Z93f8oskYabps33MKvTAz6VT12TxlrY6DZHdHCCBHN7h2tAHD6sFne1dqbzMZt/RPk1kaummb0iIQrtbWQZ+OwRlKMrmu4TH1+eeG42Xn+ghQBA6YlC2tDqTndxnos5sE71B0RN8AaDIVWjWo5CXdNukKWOOj0fzidPWwQPA7BJPf5ZI=
matrix:
  include:
  - os: linux
    dist: trusty
    env: ROS_DISTRO=indigo CXX=g++-4.9 CC=gcc-4.9
    compiler: g++-4.9
    addons:
      apt:
        packages:
        - g++-4.9
        sources:
        - ubuntu-toolchain-r-test
before_install:
- sudo sh -c "echo \"deb http://packages.ros.org/ros/ubuntu $ROS_CI_DESKTOP main\"
  > /etc/apt/sources.list.d/ros-latest.list"
- wget http://packages.ros.org/ros.key -O - | sudo apt-key add -
- sudo apt-get update -qq
- sudo apt-get install -y python-catkin-tools python-rosdep python-wstool ros-$ROS_DISTRO-catkin
  libnlopt-dev
- source /opt/ros/$ROS_DISTRO/setup.bash
- sudo rosdep init
- rosdep update
install:
- mkdir -p ~/catkin_ws/src
- cd ~/catkin_ws/ && catkin init
- cd ~/catkin_ws/ && catkin build
- source devel/setup.bash
- cd ~/catkin_ws/src && ln -s $CI_SOURCE_PATH .
before_script:
- cd ~/catkin_ws/src && wstool init
- if [[ -f $ROSINSTALL_FILE ]] ; then wstool merge $ROSINSTALL_FILE ; fi
- cd ~/catkin_ws/src && wstool up
- cd ~/catkin_ws
- rosdep install -y --from-paths src --ignore-src --rosdistro $ROS_DISTRO
script:
- source /opt/ros/$ROS_DISTRO/setup.bash
- cd ~/catkin_ws
- sudo ln /dev/null /dev/raw1394
- catkin build $REPO_NAME $( [ -f $CATKIN_OPTIONS ] && cat $CATKIN_OPTIONS )
- source devel/setup.bash
- catkin build "$REPO_NAME" --catkin-make-args run_tests
- catkin_test_results build/"$REPO_NAME" || (cat build/"$REPO_NAME"/test_results/"$REPO_NAME"/*.xml ; false)
after_success:
- 'curl -H "Content-Type: application/json" --data ''{"source_type": "Branch", "source_name":
  "''$TRAVIS_BRANCH''"}'' -X POST $DOCKER_PUSH_URL'
